# 21. Regular Expressions Advanced en JavaScript

Las expresiones regulares (**RegExp**) son patrones para buscar y manipular texto. En nivel avanzado, no solo sirven para "buscar algo", sino para hacerlo **con precisi√≥n, eficiencia y seguridad**.

## 1. Complex Patterns

Podemos combinar operadores y cuantificadores para patrones m√°s ricos:

```javascript
const pattern = /[A-Z][a-z]+(?:\s[A-Z][a-z]+)*/;
console.log(pattern.test("Juan Perez")); // true
```

**Explicaci√≥n:**

- `[A-Z]` ‚Üí Letra may√∫scula inicial.
- `[a-z]+` ‚Üí Una o m√°s letras min√∫sculas.
- `(?: ... )*` ‚Üí Grupo no capturante, repetido cero o m√°s veces (ej. nombres compuestos).

## 2. Lookahead y Lookbehind

Permiten hacer **match condicional** sin consumir caracteres en el resultado.

### Lookahead (`?=` y `?!`)

```javascript
/\d(?=px)/.test("10px"); // true (hay un n√∫mero seguido de 'px')
/\d(?!px)/.test("10em"); // true (n√∫mero NO seguido de 'px')
```

### Lookbehind (`?<=` y `?<!`) ‚Äì Soportado en ES2018+

```javascript
/(?<=\$)\d+/.test("$100"); // true (n√∫mero precedido por '$')
/(?<!\$)\d+/.test("100"); // true (n√∫mero NO precedido por '$')
```

## 3. Capturing Groups

- **Capturantes** (guardan coincidencias):

```javascript
const regex = /(\d{4})-(\d{2})-(\d{2})/;
const [, year, month, day] = "2025-08-12".match(regex);
console.log(year, month, day); // "2025" "08" "12"
```

- **No capturantes** `(?: ... )` ‚Üí No guardan, pero agrupan.

## 4. Flags avanzadas

- `g` ‚Üí Global (todas las coincidencias).
- `i` ‚Üí Ignora may√∫sculas/min√∫sculas.
- `m` ‚Üí Multil√≠nea.
- `s` ‚Üí Permite que `.` capture saltos de l√≠nea.
- `u` ‚Üí Soporte Unicode completo.
- `y` ‚Üí Sticky (busca desde la posici√≥n actual en la cadena).

**Ejemplo Unicode:**

```javascript
/\p{Emoji}/u.test("üòé"); // true
```

## 5. Unicode Support

Usar `\p{...}` con la flag `u` para clases de caracteres Unicode:

```javascript
/\p{L}+/u.test("Hola"); // true (solo letras)
```

- `\p{L}` ‚Üí letras
- `\p{N}` ‚Üí n√∫meros
- `\p{Emoji}` ‚Üí emojis

## 6. Performance

- **Evita patrones demasiado "codiciosos"** como `.*` en strings muy largos.
- Usa **cuantificadores acotados**: `{1,50}` en lugar de `*` o `+` sin l√≠mite.
- Si procesas mucho texto, **compila la RegExp una sola vez**:

```javascript
const regex = new RegExp(pattern, "g");
```

## 7. Security Considerations

- **ReDoS** (Regular Expression Denial of Service): patrones mal dise√±ados pueden bloquear el event loop.

**Ejemplo vulnerable:**

```javascript
/^(\d+)+$/; // En cadenas largas, puede colgar el proceso.
```

### Mitigaci√≥n:

- Restringir la longitud de entrada.
- Usar patrones no ambiciosos (`+?`, `*?`).
- Probar expresiones con herramientas como regex101.com o safe-regex.

## üìå Resumen r√°pido:

- Usa **lookahead/lookbehind** para validaciones condicionales sin capturar.
- Aplica **flags modernas** (`u`, `s`, `y`) para mayor control.
- Define l√≠mites para evitar **ReDoS**.
- Siempre prueba expresiones en m√∫ltiples entradas y entornos.
